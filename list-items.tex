\documentclass{article}

\usepackage[utf8]{inputenc}
\usepackage{t1enc}
\usepackage[magyar]{babel}
\sloppy

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[only,lightning]{stmaryrd}
\usepackage{halloweenmath}
\usepackage{graphics}
\usepackage{here}
\usepackage{caption}
%\usepackage{MnSymbol}
%\usepackage{arev}
%\usepackage{bclogo}
\usepackage[table]{xcolor}
\newcommand{\blk}{\cellcolor{darkgray}}
\newcommand{\gry}{\cellcolor{lightgray}}
\newcommand{\red}{\cellcolor{red!33}}
\newcommand{\grn}{\cellcolor{green!33}}
\newcommand{\ylw}{\cellcolor{yellow}}

\newcommand{\nothing}{\text{\raisebox{0.4em}{\rotatebox{180}{$\curvearrowleft$}}}}%{\mathbf{nothing}}
\newcommand{\just}[1]{\boxed{#1}}%{\mathbf{just}}
\DeclareMathOperator{\dom}{\mathbf{Dom}}
\newcommand{\incl}{\mathbf{incl}}
\newcommand{\excl}{\mathbf{excl}}
\newcommand{\parenthetical}[1]{\left(#1\right)}
\newcommand{\angled}[1]{\left\langle#1\right\rangle}
\newcommand{\setOf}[1]{\left\lbrace\,#1\,\right\rbrace}

\newcommand{\eye}{\bigtriangleup\mspace{-14.607mu}\divideontimes}

\newcommand{\mainfun}[3]{\mathwitch_{#1}^{#2}#3}
\newcommand{\yesmainfun}[3]{\bigpumpkin_{#1}^{#2}#3}
\newcommand{\nomainfun}[3]{\bigskull_{#1}^{#2}#3}
\newcommand{\currymainfun}[1]{\mathwitch_{#1}}

\newcommand{\mainfunabs}[3]{\overbat{\mathwitch*_{#1}^{#2}#3}}
\newcommand{\yesmainfunabs}[3]{\overbat{\bigpumpkin_{#1}^{#2}#3}}
\newcommand{\nomainfunabs}[3]{\overbat{\bigskull_{#1}^{#2}#3}}
\newcommand{\currymainfunabs}[1]{\overbat{\mathwitch*_{#1}}}

\newcommand{\mainfunA}[3]{\mathwitch_{#2}^{#1}#3}
\newcommand{\mainfunB}[3]{\reversemathwitch_{#2}^{#1}#3}
\newcommand{\nomainfunA}[3]{{}_{\mathwitch}\!\!\!\!\bigskull^{#1}_{#2}#3}
\newcommand{\nomainfunB}[3]{{}_{\reversemathwitch}\!\!\!\!\bigskull^{#1}_{#2}#3}
\newcommand{\yesmainfunA}[3]{{}_{\mathwitch}\!\!\!\!\bigpumpkin^{#1}_{#2}#3}
\newcommand{\yesmainfunB}[3]{{}_{\reversemathwitch}\!\!\!\!\bigpumpkin^{#1}_{#2}#3}
\newcommand{\currymainfunA}{\mathwitch}
\newcommand{\currymainfunB}{\reversemathwitch}

\newcommand{\mainfuncomm}[3]{\mathwitch_{#2}^{#1}#3}
\newcommand{\mainfunext}[3]{\left\uparrow\!\!\!\mathwitch*_{#2}^{#1}#3\right.}
\newcommand{\eyefun}[3]{\eye^{#1}_{#2}#3}

\newcommand{\gbh}[3]{\mathop{\mathghost}^{#1}_{#2}#3}

\DeclareMathOperator{\combine}{combine}

\newcommand{\storm}{\mathcloud\mspace{-42mu}\lightning\mspace{3mu}\lightning\mspace{20mu}}

\newcommand{\progr}[1]{\left|#1\right|}

\setcounter{tocdepth}4

\usepackage{multirow}
\usepackage{array}
\setlength{\extrarowheight}{4px}

\usepackage{comment}
\usepackage{hyperref}

\title{100. feladvány}
\author{Endrey Márk}

\begin{document}
	\maketitle

	\tableofcontents

	\section{A feladat és a válaszok}

	A feladatra való megoldásom lényege egy rekurzió felismerése. Ez alapján kétféle protokollalgoritmus is adtam a négy testvér számára.
	Ezek optimalitása, az erőforrásokkal való takarékossága különböző fokú, de mindkettő képes a király által támasztott korlátokon belül megadni a helyes választ.

	Mindez a bárányok tetszőleges elrendezésére és a királylány tetszőleges nyájhoz való csapódása illetve különbarangolása esetében igaz.
	Nagyon erős sejtés, hogy a ,,kevésbé szélsőséges'', ,,a kiegyensúlyozottabb'', ,,homogénebb'' nyájbeosztások esetén a két algoritmus optimalitási különbsége csökken, a kevésbé optimális algoritmus ,,hátránya'' enyhébb.

	Mindkét protokollalgoritmusra igaz, hogy nem hasznáják föl a teljes információt (a testvérek csak azt nézik, összesen hány bárányt látnak, és nem használják ki, hogy jobb kezük felül hányat külön, és bal kezük felől hányat külön). Nagyon erős sejtés, hogy a teljesen homogén nyájleosztás esetén (25--25--25--25) ez nem okoz erőforrásvesteséget, és ez esetben mindkét algoritmus optimális.

	Ezek alapján az egyes  kérdéskere adott válaszaim:

	\begin{quotation}
		Alapkérdés: ,,\textit{[\dots] melyik legény felelt meg, hányadik kérdésre, és mit felelt?}''
	\end{quotation}

	Válasz: Amennyiben az optimalitási sejtés igaz, akkor: \textbf{a 26.~menetben} fog felelni a \textbf{kezdő testvérrel szemközt álló testvér}, vagyis a harmadik testvér (illetve a végső ,,abszolút protokollfüggvény''-táblázatban használt 0-indexű testvérszámozás szerinti 2.~testvér). Ez mindkét protokollalgoritmus esetén így van, a testvérnégyes mindkét protokollalgoritmus szerint dolgozhatik.
	
	\begin{quotation}
		Haladó kérdés: ,,\textit{Mi lett volna akkor, ha a király nem egyenlően osztja el a bárányokat? Tetszőleges elosztásban is megoldható lett volna a feladat, ha elég okosak a kérők?}''
	\end{quotation}

	Válasz: Mindkét protokollalgoritmus teljesíti a király által megszabott korlátokat tetszőleg nyájelrendezés és a királylány tetszőleges döntése esetén is.

	\section{Bevezetés}

	\subsection{,,Tudatemlélettel'' rendelkező aktornégyes}

	Egyet azonnnal biztosan láthatunk: ha egy testvér 101 birkát lát maga körül, azonnal készen állhat a helyes válasszal: a királylány nem kóborolt el!

	Ezenkívül azt is észrevehetjük, hogy az egymással szembenálló (tehát nem szomszédos!) testvérpárok közt egyfajta komplemetaritás teljesül: ketten-ketten együtt pont a nyáj összes birkáját számoljk le. ha az egyik 30-at lát, akkor a másik 70-es vagy 71-et, attól függően, hogy a kriálylány a nyájhoz csapódott-e, vagy különbarangolt. Különös módon a szemközti testvérpárok közt szorosabb kacsolat van, mint a szomszédosak közt.

	E két felismerésen túl azonban a feladat nehéz (még akkor is, ha azzal könnyítjük, hogy a nyáj 100 helyett csak négytagú).
 
	A testvérek nyilvánvalóan valamilyen protokollt fognak használni. Egyetlen lehetőségük van arra, hogy ,,kommunikáljanak'' egymással, vagyis egyetlen fajta információ tud ,,átadódni'' közöttük: minden egyes testvér tudnak következtetést levonni abból, hogy a király vajon miért nem állt meg korábban egy előtte levő testvérnél, és miért ment tovább őhozzá. Például, ha egy testvér pontosan 0 birkát számol össze az általa részletesen is belátott mezőkön, akkor tud következtetni arra, hogy a vele pont szemben lévő testvér csakis 100 vagy 101 birkát láthat részletesen be. Amennyiben azt is tudja, hogy a király már járt ennél a bizonyos szembenlevő testvérnél, akkor abból a tényből, hogy a király onnan továbblépet őhozzá, máris kikövetkeztetheti, hogy a szembenlévő testvérnél csakis 100 birka lehet. Ugyanis ha 101 birka lett volna ott.

	A testvérek egy képzeletbeli ,,labdát'' adnak körbe egymásnak, ahol a szembenállók állnak igazán játékkapcolatban. Minden egyes testvér tudja figyelni, hogy vele szembenálló társa ,,továbbadja''-e neki a labdát, vagy ,,elkapja''.

	\subsubsection{,,Tudom, hogy tudod, hogy tudom, hogy tudod\dots''}

	A közismert gúnyos mondás ezúttal szó szerint vehető rekurziós tanáccsá válik:

	\begin{itemize}
		\item 101: Ha 101 bárányt látsz, társad csakis 0-t láthat, és a ladbdát te biztos nem tőle, hanem a királytól kaptad. És ne is engedd át neki a labdát, hanem a királynak: azonnal jelentsd be hogy a királylány a nyájban van.
		\item 0: Ha   0 bárányt látsz, társad 101-et vagy 100-at láthat. Ha ő volt már, akkor biztos, hogy nem 101-et, ekkor jelents be, hogy a királylány elkóborolt. Ha ő nem volt még, engedd át neki a labdát. Ha 101 báránya van, tőled függetlenül be fogja jelenteni, hogy a királynő a nyájban van, de ha 100 báránya van, akkor  épp a te átengedésed tényéből fogja megtudni, hogy te 0 bárányt látsz, ő erre alapozva be fogja jelenteni, hogy a királylány ekóborolt.
		\item 100: Ha 100 bárányt látsz, társad 0-t vagy 1-et láthat. Mindenképp engedd át számára a labdát (akár tőle, akár a királytól kaptad). Ha ő 0-t lát, be fogja jelenteni, hogy a királylány elkóborolt. Ha ő 1-et lát, vissza fogja neked dobni a labdát. Ekkor jelents be hogy a királylány a nyájban van.
		\item 1: Ha 1 bárányt lász, társad 100-at vagy 99-et láthat. Engedd áát neki a labdát. ugyanis ha ő 100-at lát, kíváncsi lesz rá, hogy te 0-t vagy 1-et látsz-e, így vissza fogja dobni neked.
	\end{itemize}

	\subsection{Egyszerűbb rávezető feladatok?}

	Mivel fentebb láthattuk, hogy valamiféle rekurziós, redukciós lépés várható a megoldás során, ezért megpróbáljuk az eredeti feladatot először egy rávezető egyszerűbb feladattal helyettesítni, pusztán afféle tpsztalatgyűjtés céljából. Több szempoont is eszünk bejuthat: 

	\begin{itemize}
		\item Csökkentjük a ,,kör'' méretét (pl.~4 helyett 3, vagy 4 helyett 2)
		\item Csökkentjük a birkák számát ($100 + 1$ helyett $4 +1$, ami afféle végső egyszerűsítés, hisz a birkák száma megegyezik a kör méretével. Bár ez is nehéz, de ez már plauzibilis kihívás, jobban el tudi indulni az ember, főleg, hogy még további egérút is van: $3 +1$, $2 + 1$, $1 + 1$, és végső egyszerűsítésképp $0 + 1$, ami a lehetséges elképzelhető minimum.
	\end{itemize}

	\subsubsection{Kör tagszámára alapozó egyszerűsítés}

	Meglepő módon a ,,4 helyett 3'' viszont egyelőre nem tűnik számomra tapasztatszerzsés szempontjából  lényegi könnyítésnek, redukció szempontjából meg  visszalépésnek: a 3-as eset akár még bonyolultabb is lehet következtetéek szempontjából (nem jön létre ,,párkommunikációs'' alprotokoll!).

	Tehát maradunk a 4-tagú körnél, viszont azt viszont sokat fogjuk kihasználni, hogy a szembenálló testvérek egyfajta ,,párkommunikációt'' folytatnak egymással. Ezeket a ,,párkommunikációs alprotokollokat'' már valóban afféle 2-tagú körként fogjuk modellezni és formalizálni.%Egyfajta ,,4 helyett 2''-ról ugyan lehet beszélni, de az a ,,$100 + 1$ helyett'' megközelítésből adódik nagyon szerves, arra külön jellemző okokból.

	%A továbbiakban nagyrészt e létszámredukció lesz érvényben az írás folyamán, és az általánosítások is e mentén történnek.
	%A végén talán még visszatérünk a körredukciós, és főleg a köráltalánosítási kérdésekre is.

	\subsubsection{Nyáj létszámára alapozó egyszerűsítés}

	A $100 + 1$ helyett $4 + 1$ redukció lesz érvényes az írás nagy részében, mindenütt, ahol értelemszerűen látszik (azaz mindenütt, ahol a 4-esek és 5-ösök szerepe kitüntetettként szerepel), ezt amúgy a ,,szumma-jellegű'' függvények ,,fölső'' paramétere explicit is jelezni is fogja (konkrétan a $\displaystyle\mainfuncomm Nqk$ párkommunikációs relatív alprotokollfüggvény, a $\displaystyle\mainfunext Nqk$ kitejesztett relatív protkollfüggvény, és a $\mathop{\bigtriangleup\mspace{-14.607mu}\divideontimes}\limits_N^qk$ abszolút protokollfüggvény $N$-paramétere).

	Lehet bizonyos értelemben még jobban is egyszerűsíteni létszám terén, és a $4+1$ helyett $0+1$,  $1+1$,  $2+1$,  $3+1$. Eredetileg ezzel kezdtem a feladat megoldását, de ennek tanulságait nem összegeztem külön, hanem beleépítettem a $4+1$ jellegű egyszerűített feladatba.


	\section{A párkommunikációra elvonatkoztató modell és alprotokoll}

	A párkommunikációra elvonatkoztató alprotokoll azt jelenti, hogy a továbbiakban elvonatkoztatunk a 4-tagú körötől és a 4 testvértől, és két ügyfél (aktor) kommunikációjának tekintjük a feladatot.
	Ez kb.~azt jelenti, mintha csak az első és a vele szembenlevő harmadik testvér lenne csak jelen. A többi testvérnek nincs szerepe, létük egyszerűen belolvad a kommunikációs ,,csatorna'' közegébe. 

	Fontos látni, hogy a párkommunikációra elvonatkoztató alprotokoll teljes mértékben és minden helyzetben semmiképp sem lehet egyenrangú, ekvivalens a lehetséges optimális protokollokkal.

	Például, ha az induló (első) legény és a második legény közti mezőn két bárány van, a második és a harmadik testvér közt pedig három bárány, akkor a második legény azonnal észlehetné, hogy ő összesen öt bárányt lát, ami nagyobb, mint a nyáj teljes létszáma (4), tehát máris jelenthetné, hogy a királylány szükségszerűen a nyájban van, a kör azonnal megszakadnék.

	A párkommunikációra elvonatkoztató protokoll szerint viszont az első és a harmadik legény közt zajlik az  érdemi protokoll (a második legény pedig, ha létét modellezük egyáltalán, mindenre csak azt mondja, ,,nem tudom'', mintegy automatikusan továbbadva a labdát, tehát lényegében csak passzívan továbbadja a kört az első legénytől a vele szemben lévő harmadik legyén felé). Ugyanilyen passzív továbbitó szerepet tölt be a negyedik legény is, aki a harmadik legénytől továbbít az első legény felé. Az érdemi protokollkommunikáció tehát az első és a vele szembenlevő harmadik legény közt zajlik, akik majd a kiegészítés-elv alapján rekurziós megfontolások alapján majd sokadik körben majd kitalálják, hogy öt bárány van, a királylány tehát nem kóborolt el. Ezt azonban a második legény azonnal ki tudta volna találni, ha nem kényszerült volna passzív szerepre a ,,párkommunikációra elvonatkoztató alprotokoll'' modellje miatt.

	Persze a példában a birkák is eléggé szélsősegesen helyezkedtek el. Kiegyensúlyozottab, homogénebb nyájpartíció esetében a ,,párkommunkációra elonatkoztató alprotokoll'' mint modell és megoldás valószínűleg nem ennyire erőforrástékozló. (Erős sejtés).

	A párkommunikációra elvonatkoztató alprotokoll tehát semmiképp sem optimális erőforrásigényű általános esetben: nem használja ki optimálisan a rendelkezésre álló információt, erődorrást pazarol. Azonban ez azon múlt, hogy az egyik legénynél szélsőségesen jó helyzetben volt. A lehető legkiegyensúlyozottabb, leghomogénebb esetben (minden bárány egyenletesen van elosztva a négy mező közt) akár olyannyira is kisebb lehet az  hátrány, amit párkommunikációra elvonatkoztató protokoll információ-és erőforráspazarlása okoz, hogy akár még az is lehetséges, hogy az ilyen homogén esetekben ez  protokoll optimális tud lenni. (Erős sejtés.)

	\subsection{Relatív alprotokollfüggvény(pár), aktor-pár, emergencia}

	Tehát munkahipotézisként fogadjuk el a párkommunikációra elvonatkoztató alprotokoll által nyújtható modellt. \emph{Két} kommunikáló ügyfelünk van, ők önálló, meglehetősen autonóm ágensek, aktorok, viselkedésüket saját maguk irányítják a bennük lévő protkollfüggvény alapján, a mi érdeklődésünk tárgya pedig épp az általuk alkotott teljes rendszer ,,emergens'' viselkedése, az észlehető protokoll ,,kiemelkedése'', miként a termeszek is bonyolult bolyt építenek úgy, hogy az egyes termesz viselkedése valójában egyszerű triggerekre épül pár szabály (szagok, társas távolságok) alapján.

	Az egyéni aktorok proorkollfüggvényét többnyire a ,,relatív protokollfüggvény'' jelzővel fogom illetni, megkülönböztetésül a teljes rendszert viselkedését expliciten, mintegy kézivezérelten, emergenciára nem hivatkozóan leíró ,,abszolút protokollfüggvénytől''. Az abszolút protokollfüggvény megadása majd a feladat legvégső lépése lesz, amiből a válaszok már közvetlenül fognak adódni.

	Mindenesetre ez még mesze van, egyelőre még sokáig a relatív protokollfüggvények megadása van terítéken.

	\subsection{Kölcsönös rekurzó --- protokollszumma, protokoll-koszumma}

	 \dots (,,boszorkányszumma, ellenboszorkányszumma''), és a társelőzménylehetőség-kombináló segédfüggvény.


	A kommunikáció az egyik ,,induló'' ágensnél kezdődik --- az ő relatív protokollfüggvényét jelölje a $\mainfunA Nqk$ függvény ---, a másik aktor relatív protokollfüggvényét pedig  $\mainfunB Nqk$ jelöli. A $N$ paraméter és a $q$, $k$ argumetum jelentése:

	\begin{description}
		\item[Az $N$ paraméter] itt (és még elég sokáig ebben az írásban) $N=4$ értékű --- 4 birka a nyáj teljes létszáma, amibe nincs belertve az akár hozzácsapódó, akár különkóborló királylány.
		Az írás végén természetesen $N=100$ paraméterértékkel számolt protokollfüggvények is lesznek.
		A lehetséges értékek tehát $N \in \mathbb N$, az eredmények általánosak.

		\item[A $q$ argumentum] a zajló kommunikáció egyfajta ,,életkorát'' ,,menetszámlálóját'' jelzi.
		Lehetséges értékei:
		\begin{itemize}
			\item a $q = 0$ érték azt jelenti, hogy a kommunikáció épp most, és épp pont az adott aktornál kezdődött el (,,épp most lépett oda elsőként a király''). A $q = 1$ érték azt jelenti, hogy épp a második körbe lépett az adott aktor (,,épp most ért körbe egy teljes kört a király'').
			\item A $q$ nem egyesével, hanem ,,felesével'' változik: a $q = \frac12$ azt jeleti, hogy a kommunikáció nem az aktuális, hanem a ,,társaktornál'' indult (a másik aktornál kezdett a király), és természetesen a $q = 1\frac12, 2\frac12 \dots$ jelentése, hogy már 1 (2, stb \dots) teljes kör lement ezen felül.
			\item Formális jelentősége van a $q = -\infty$ lehetséges értéknek. Ez jelképezi a még soha meg nem szólított aktort: az aktor amaz állapotát, amikor a kommunkáció még el sem indult egyáltalán. Egyfajta permanenciaelv folytán (vithathatóan) megkönnyít egyes definíciókat, specifikációkat, de ki lehet küszöböni a használatát.
			\item $q = +\infty$ érték bevezetésének más okból lenne értelme: akkor lenne értelme, ha vizsgálnánk azokat a lehetetlennek bizonyuló szituációkat, meg nem történő kimeneteleket is, amelyeket az aktor-pár, illetve a belőlük emergálódó rendszer tetszőleges számú kör után sem tud elérni (vagyis a király elengedi a 100-körös korlátot). Itt ebben a feladatban ilyesfajta értékkészlet- és egyéb vizsgálatok nem lesznek (bár az értelmezési tartományok vizsgálata igen), szóval $q = +\infty$ értéket nem használunk.
		\end{itemize}
		Összesítve: a lehetséges értékek tehát $q \in \setOf{-\infty, 0, \frac12, 1, 1\frac12\dots}$.

		\item[A $k$ argumentum] jelenti azt, hogy az adott aktor hány brányt tud összeszámolni összesen.
		A modell tehát nem használja ki és nem is modellezi, hogy a valós feladatban minden egyes legény azt is észleli, hogy hány bárány van az ,,egyik'' oldalára, egyik keze felé eső mezőben, és hány van a másik keze felőli mezőben. Mindez azt is előrevetíti, hogy az e modell és protokolfüggvények által meghatározható protokoll nem lesz optimális, legalbbis nem minden esetben. Van egy nagyon erős sejtés arra nézve, hogy a feladatban kitűzött homogén báránypartíció (25--25--25-25) esetében ez a hátrány elenyészik, és az optimalitást nem veszi el.

		Mindenensetre $k$ lehetséges értékei természetesen: $k\in\setOf{0\dots N+1}$.

		\item[A függvények által visszadott lehetséges értékek:] pontosan azok a válaszlehetőségek, amelyeket a testvérek kiejthtnek a szájukon a király felé. Egyfajta \texttt{Maybe Bool}: ,,\textit{Tudom: igen!}'', ,,\textit{Tudom: nem!}'', ,,\textit{Nem tudom!}''. Jelölésekkel: $\mainfunA Nqk, \mainfunB Nqk \in \setOf{\nothing, \just\incl, \just\excl}$.
		\begin{itemize}
			\item $\nothing$: ,,továbbadja a kommunikációs labdát (protokoll-labdát, protokolltokent)'' a társ-aktornak, vagyis azt feleli a király kérdésére: ,,Nem tudom!''.  Azaz ,,továbbengedi a királyt'' --- nem szakad meg a kör, halad tovább a teljes rendszer protokollviselkedése.
			\item $\just\incl$: azt feleli a király kérdésére: ,,Megadom a választ:  a királylány a nyájjal van, hozzácsapódott!''. Ezzel meg is szakítja a kört, vége a kommunikációnak, a teljes rendszer protokollviselkedésének.
			\item $\just\excl$: azt feleli a király kérdésére: ,,Megadom a választ:  a királylány nincs a nyájjal, elkóborolt!''. Ezzel meg is szakítja a kört, vége a kommunikációnak, a teljes rendszer protokollviselkedésének.
		\end{itemize}
		A válasz ,,adatszerkezete'' egyébként pontosan az, amit a funkcionális programnyelvek \texttt{Maybe}-ként (itt konkrétan \texttt{Maybe Bool}-ként) ábrázolnak:
		\begin{itemize}
			\item A $\just{\dots}$ jelentése: akár $\just\incl$, akár $\just\excl$, szóval mindkettőre illeszkedő minta.
			\item A $\hat\lnot$ jelentése: a $\just\dots$-on ,,átvetített'' (\texttt{map}-elt) logikai tagadás:
			\begin{align*}
				\mathop{\hat\lnot}\just\incl = \just{\lnot\incl} = \just\excl\\
				\mathop{\hat\lnot}\just\excl = \just{\lnot\excl} = \just\incl
			\end{align*}
		\end{itemize}
	\end{description} 
	
	Most akkor íme definiáljunk mindkét függvényt, szóval mind a $\mainfunA Nqk$, mind a $\mainfunB Nqk$ függvényt az egymástól való kölcsönös rekurzióval, és az argumentumok jellegéből következő triviális kiindulófeltételekkel!

	\begin{align}
		\intertext{Legyen $N \in \mathbb N; k \in \setOf{0, \dots, N+1}$:}
		\mainfunA N{-\infty}k = \mainfunB N{-\infty}k &= \nothing
		\intertext{\dots vagyis az aktorok kommunikáció előtti állapotát formálisan úgy modellezzük, hogy nyitottak a kommunikációra, nem zárkóznak el a kommunikációtól, nem szakítják meg eleve a kört, mielőtt még a király egyáltalán mozogni kezdene: ,,nem szöknek el a toronyból eleve''. Formálisan tehát olyan értelemben ,,adják tovább a labdát'', hogy a kommunikációva egyáltaláb be tudnak lépni.}		\intertext{A fenti szabály felesegessé teszi, hogy a $q=0$ esetét külön deklaráljuk (mert rekurziósan következik a másik két deklarációból, ha elfogadjuk, hogy $0-\frac12 = -\infty$), de azért említsük meg explicite meg 0-ra is is:}
		\mainfunA N0k=\mainfunB N0k &= \begin{cases}\nothing&\text{ha } k < N+1\\\just\incl&\text{ha }k=N+1\end{cases}
		\intertext{A 0-s szabállyal talán ki lehetne váltani a $-\infty$-es szabályt, de a $-\infty$-es szabály még jól fog jönni a protokolfüggvény kitejesztésekor.}
		\intertext{Újra független szabály: Legyen $N \in \mathbb N; q \in \setOf{0, \frac12}$:}
		\mainfunA Nq{\parenthetical{N+1}} = \mainfunB Nq{\parenthetical{N+1}} &= \just\incl\\
		\intertext{\dots vagyis az az aktor, aki épp észleli, hogy az őáltala összeszámolható bárányok száma eggyel nagyobb, mint a nyáj teljes látszáma, az legott azonnal tudja is a választ: a királylány a nyájjal van! (Ez persze $q > \frac12$ értékre nem történhetik meg, vagyis az első körön túl: hiszen ha egy aktor a második körben észlelné a királylány jelenlétét, akkor azt már az első körben is észlelte volna, vagyis még akkor megszakította volna a kört.)}
		\intertext{Most jöhet a lényeg: a rekurziós szabály. Legyen $N \in \mathbb N$; $q \in \setOf{0, \frac12, 1, 1\frac12\dots}$; $k \in \setOf{0, \dots, N}$:}
		\mainfunA Nqk &= \oplus\begin{cases}\displaystyle\mainfunB N{q-\frac12}{N-k}&\\\\\displaystyle\mainfunB N{q-\frac12}{N-k+1}&\end{cases}\\\\
		\mainfunB Nqk &= \oplus\begin{cases}\displaystyle\mainfunA N{q-\frac12}{N-k}&\\\\\displaystyle\mainfunA N{q-\frac12}{N-k+1}&\end{cases}
		\intertext{\dots épp ez a rekurziós lépés, vagyis a feladat bevezetőjében említett jellegzetes ,,\textit{Tudom, hogy tudod, hogy tudom\dots}'' jellegű következetetés, amely tudja, hogy a szemeben lévő partnernél épp a komplementer számú birka van, vagy komplementer plusz egy, és e két lehetőségből tud következtetni arra, hogy ebből tudható-e azonnal a válasz, vagy engedje-e tovább a kört. A rekurzió jól látszik, és az is, hogy felhasznál egy amúgy egyszerű $\oplus$ segédfüggvényt is, amely csak a már kikövetkeztetett lehetséges ,,szembenértékek'' között kombinál:}
	\end{align}

	\subsubsection{Segédfüggvények}

	A $\oplus$ segédfüggvény:

	\begin{align*}
		\oplus &: \text{Válasz} \times \text{Válasz} \to \text{Válasz}\\
		\dom_\oplus &= \begin{cases}\angled{\nothing, \nothing}&\\\angled{\just\dots, \nothing}&\\\angled{\nothing, \just\dots}&\end{cases}\\
		\nothing   &\oplus \nothing            & &\mspace{-214mu}=  \nothing   \\
		\just P &\oplus \nothing            & &\mspace{-214mu}=  \just{\lnot P} \\
		\nothing   &\oplus \just P          & &\mspace{-214mu}=  \just{\lnot P} \\
		\langle\just\dots &, \just\dots\rangle & &\mspace{-214mu}\notin \dom_\oplus
	\end{align*}

	Mivel a $\oplus$ segédfüggvény jól láthatóan parciális függvény (pontosabban szólva értelmzési tartománya bonyolult összetételű), ezért a belőle definiált $\mainfunA Nqk$ és $\mainfunB Nqk$ függvény is ,,parciális'' lesz, sőt ezek értelmezési tatománya szintén bonyolult lesz (majd látni fogjuk, afféle ,,lépcsős'' jellegű). Ez természetes: egyes szituációk késői körökben nmár nem fordulhatnak elő, mert már korábbi körök ,,kibuktatják'' őket.

	A későbbiekben terjedelmes táblázatok is lesznek. Ezek értékek felsorolása mellett utalni fognak arra is, ha valamely szituációk ,,kibuknak'' és a későbbiekben lehetetlenné válnak. A tömör jelölés érdekében a protokollfüggvények értelmezési tartományára bevezejük az alábbi ,,élőségi predikátum'' jelöléseket:

	\begin{align}
		\yesmainfunA Nqk &\iff \angled{N,q,k}\in\dom_{\mathwitch} \\
		\yesmainfunB Nqk &\iff \angled{N,q,k}\in\dom_{\reversemathwitch} \\\intertext{illetve ezek tagadásait:}
		\nomainfunA  Nqk &\iff \angled{N,q,k}\notin\dom_{\mathwitch} \\
		\nomainfunB  Nqk &\iff \angled{N,q,k}\notin\dom_{\reversemathwitch}
	\end{align}

	\subsection{Az aktorpár szimmetriája, ,,autonómabb'', ,,emergensebbb'' viselkedés}

	A feladat szempontjából (és sok más gyakorlatban érdekes helyzetben) az aktoroknak nem kell lényegesen különböző protokollalgoritmust használniuk, ,,programozhatják őket ugyanúgy is''.
	Nyugodtan előfelttelezük a továbbiakban, hogy a  $\mainfunA Nqk$ és $\mainfunB Nqk$ függvény teljesen azonos: értékhozzárendeléseikben és persze értelmezési tartományukban is:

	\begin{align}
		\currymainfunA     &\equiv \currymainfunB     \\
		\yesmainfunA{}{}{} &\equiv \yesmainfunB{}{}{} \\
		\nomainfunA{}{}{}  &\equiv \nomainfunB{}{}{}
	\end{align}

	%A protokollfüggvény tulajdonsága, hogy tagjaira szimmetrikus ($0, 1, 2, 3,4$) és 
	%\[\mainfunA4{-\infty}5, \yesmainfunA4{-\infty}5, \nomainfunA4{-\infty}5\]


	\subsection{A rekurzió kiszámítása}

	A $\mainfunA Nqk$ és $\mainfunB Nqk$ relatív alprotokollfüggvény-párost azért építettük fel így, mert szeretnénk, hogy \emph{jóslóerejűek} legyenek: a belőlük emergensen kielelkedő teljes rendszer kiszámítható ,,abszolút'' protokolltáblázatából már mindenfajta lehetséges birkapasrtícióra és királylányhelyzetre lehessenk következtetni, legalább megkötés nélküli kör után ($+\infty$), de lehetőleg a (király által) megadott erőforrás-korlátokon belül is. Az előfordulható belső szituációkat az értelmezési tartomány mutatja ($\yesmainfunA4 Nqk$ élőségi és $\nomainfunA Nqk$ lehetetlenségi predikátum).

	A rekurziós lépések rendre a két aktor közti egyfajta komplementaritásra, illetve annak indeterminizmusára, ,,holtjátékára'' épülnek:
	\begin{align*}
		\intertext{$N = 4$ bárány esetén}
		0 &\mapsto \setOf{4; 5}\\
		&\vdots\\
		4 &\mapsto \setOf{0; 1}\\
		5 &\mapsto \setOf{0}\\
		\\\intertext{illetve $N = 100$ bárány esetén}
		0 &\mapsto \setOf{100; 101}\\
		&\vdots\\
		100 &\mapsto \setOf{0; 1}\\
		101 &\mapsto \setOf{0}
	\end{align*}

	Lássunk neki a rekurzió kiszámításának. A teljes számítást el fogjuk végezni, de itt most csak az $N = 4$ esetre.

	A rekurziós lépés $\oplus$ kombináló segédfüggvényét itt a $\text{\bf mert}$ szó (szinonimaként a $\text{\bf mert}_\frac12$ szó is) fogja jelölni. Lesz majd egy $\text{\bf mert}_\frac12$ féle érvelés is mutatva, de ez levelezhető a sima $\text{\bf mert}$ ($\text{\bf mert}_\frac12$) szabályból, léte redundáns, afféle gyorszabály: a táblázatok áttekintését majd meg fogja könnyíteni.

	
	\begin{align*}
		\mainfunA4{-\infty}0 &= \nothing \\
		\mainfunA4{-\infty}1 &= \nothing \\
		\mainfunA4{-\infty}2 &= \nothing \\
		\mainfunA4{-\infty}3 &= \nothing \\
		\mainfunA4{-\infty}4 &= \nothing \\
		\mainfunA4{-\infty}5 &= \nothing
	\end{align*}

	\begin{align*}
		\mainfunA4{0}0  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{-\infty}4 = \nothing\\\mainfunB4{-\infty}5 = \nothing&\end{cases} \\
		\mainfunA4{0}1  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{-\infty}3 = \nothing\\\mainfunB4{-\infty}4 = \nothing&\end{cases} \\
		\mainfunA4{0}2  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{-\infty}2 = \nothing\\\mainfunB4{-\infty}3 = \nothing&\end{cases} \\
		\mainfunA4{0}3  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{-\infty}1 = \nothing\\\mainfunB4{-\infty}2 = \nothing&\end{cases} \\
		\mainfunA4{0}4  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{-\infty}0 = \nothing\\\mainfunB4{-\infty}1 = \nothing&\end{cases} \\
		\mainfunA4{0}5  &= \just \incl &&\text{, mert }\begin{cases}\mainfunB4{-\infty}0 = \nothing&\text{--- tehát egyértelmű: csak egy eset van}\end{cases}
	\end{align*}

	\begin{align*}
		\mainfunA4{\frac12}0  &= \just \excl &&\text{, mert }\begin{cases}\mainfunB4{0}4 = \nothing\\\mainfunB4{0}5 = \just \incl&\text{--- így nem jut el hozzá}\end{cases} \\
		\mainfunA4{\frac12}1  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{0}3 = \nothing\\\mainfunB4{0}4 = \nothing&\end{cases} \\
		\mainfunA4{\frac12}2  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{0}2 = \nothing\\\mainfunB4{0}3 = \nothing&\end{cases} \\
		\mainfunA4{\frac12}3  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{0}1 = \nothing\\\mainfunB4{0}2 = \nothing&\end{cases} \\
		\mainfunA4{\frac12}4  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{0}0 = \nothing\\\mainfunB4{0}1 = \nothing&\end{cases} \\
		\mainfunA4{\frac12}5  &= \just \incl &&\text{, mert }\begin{cases}\mainfunB4{0}0 = \nothing&\text{--- az egyetlen eset el is jut hozzá: $\angled{\frac12,5}\in\dom\currymainfunA$, azaz $\yesmainfunA4{\frac12}5$}\end{cases}
	\end{align*}

	\begin{align*}
		\mainfunA410  &= \just \excl &&\text{, mert }\begin{cases}\mainfunB4{\frac12}4 = \nothing\\\mainfunB4{\frac12}5 = \just \incl&\text{--- így nem jut el hozzá}\end{cases} \\
		\mainfunA411  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{\frac12}3 = \nothing\\\mainfunB4{\frac12}4 = \nothing&\end{cases} \\
		\mainfunA412  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{\frac12}2 = \nothing\\\mainfunB4{\frac12}3 = \nothing&\end{cases} \\
		\mainfunA413  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{\frac12}1 = \nothing\\\mainfunB4{\frac12}2 = \nothing&\end{cases} \\
		\mainfunA414  &= \just\incl  &&\text{, mert }\begin{cases}\mainfunB4{\frac12}0 = \just\excl\\\mainfunB4{\frac12}1 = \nothing&\text{--- nem jut el hozzá}\end{cases} \\%\intertext{\[\storm\]}
		&\nomainfunA415              &&\text{, mert}_{\frac12}\begin{cases}\mainfunB4{\frac12}0 = \just\excl&\text{--- nem jut el hozzá, így $\angled{1,5}\notin\dom \currymainfunA$}\end{cases}\\
		&                           &&\text{, mert}_1\mainfunA405 = \just\incl\text{ --- alternatív bizonyítás}\\
		&                           &&\text{\hspace{7em}mostantól külön szabály}_1 \text{ az eddigi szabály}_\frac12 \text{mellé}\\
		\intertext{\vspace{-1em}\[\storm\storm\storm\storm\storm\storm\]}
		%{\mathcloud\mspace{-42mu}\lightning\mspace{3mu}\lightning}\mspace{20mu}\nexists\mainfunA415\bigskull\bigskull  & \text{, mert }\begin{cases}\mainfunB4{\frac12}0 = \just\excl&\text{--- nem jut el hozzá, így $\angled{\frac12,5}\notin\dom P_0$}\end{cases}
	\end{align*}

	\begin{align*}
		&\nomainfunA4{1\frac12}0              &&\text{, mert}_{\frac12}\begin{cases}\mainfunB414 = \just\incl&\text{--- innen már nem juthat el hozzá}\\\nomainfunB415&\text{--- ez meg már nincs is a lehetőségek között}\end{cases} \\
		&                                    &&\text{, mert}_1\mainfunA4{\frac12}0 = \just\excl\\
		\mainfunA4{1\frac12}1  &= \just\excl  &&\text{, mert }\begin{cases}\mainfunB413 = \nothing\\\mainfunB414 = \just\incl&\text{--- innen nem juthat tovább}\end{cases} \\
		\mainfunA4{1\frac12}2  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB412 = \nothing\\\mainfunB413 = \nothing&\end{cases} \\
		\mainfunA4{1\frac12}3  &= \nothing    &&\text{, mert }\begin{cases}\mainfunB411 = \nothing\\\mainfunB412 = \nothing&\end{cases} \\
		\mainfunA4{1\frac12}4  &= \just\incl  &&\text{, mert }\begin{cases}\mainfunB410 = \just\excl&\text{--- nem jut el hozzá}\\\mainfunB411 = \nothing&\end{cases} \\%\intertext{\[\storm\]}
		&\nomainfunA4{1\frac12}5              &&\text{, mert}_{\frac12}\begin{cases}\mainfunB410 = \just\excl&\text{--- nem jut el hozzá}\end{cases}\\
		&                                    &&\text{, mert}_1 \mainfunA4{\frac12}5 = \just\incl
	\end{align*}

	\begin{align*}
		&\nomainfunA420               &&\text{, mert}_\frac12\begin{cases}\mainfunB4{1\frac12}4=\just\incl\\\nomainfunB4{1\frac12}5\end{cases}\\
		&                            &&\text{, mert}_1\mainfunA410=\just\excl\\
		\mainfunA421   &= \just\excl  &&\text{, mert }\begin{cases}\mainfunB4{1\frac12}3 = \nothing\\\mainfunB4{1\frac12}4 = \just\incl&\text{--- innen nem juthat tovább}\end{cases}\\
		\mainfunA422   &= \nothing    &&\text{, mert }\begin{cases}\mainfunB4{1\frac12}2 = \nothing\\\mainfunB4{1\frac12}3 = \nothing&\end{cases}\\
		\mainfunA423   &= \just\incl  &&\text{, mert }\begin{cases}\mainfunB4{1\frac12}1 = \just\excl\\\mainfunB4{1\frac12}2 = \nothing&\end{cases}\\
		&\nomainfunA424               &&\text{, mert}_\frac12\begin{cases}\nomainfunB4{1\frac12}0\\\mainfunB4{1\frac12}1 = \just\excl&\text{--- nem jut el hozzá}\end{cases}\\
		&                            &&\text{, mert}_1\mainfunA414=\just\incl\text{ --- nem jut el hozzá}\\
		&\nomainfunA425               &&\text{, mert}_\frac12\begin{cases}\nomainfunB4{1\frac12}0\end{cases}\\
		&                            &&\text{, mert}_1\nomainfunA415
	\end{align*}

	\begin{align*}
		&\nomainfunA4{2\frac12}0               &&\text{, mert}_\frac12\begin{cases}\nomainfunB424\\\nomainfunB425\end{cases}\\
		&                                     &&\text{, mert}_1\nomainfunA4{1\frac12}0\\
		&\nomainfunA4{2\frac12}1               &&\text{, mert}_\frac12\begin{cases}\mainfunB423 = \just\incl&\text{--- innen nem juthat tovább}\\\nomainfunB424\end{cases}\\
		&                                     &&\text{, mert}_1\mainfunA4{1\frac12}1 = \just\excl\\
		\mainfunA4{2\frac12}2   &= \just\excl  &&\text{, mert }\begin{cases}\mainfunB422 = \nothing\\\mainfunB423 = \just\incl&\text{--- innen nem juthat tovább}\end{cases}\\
		\mainfunA4{2\frac12}3   &= \just\incl  &&\text{, mert }\begin{cases}\mainfunB421 = \just\excl&\text{--- innen nem juthat tovább}\\\mainfunB422 = \nothing&\end{cases}\\
		&\nomainfunA4{2\frac12}4               &&\text{, mert}_\frac12\begin{cases}\nomainfunB420\\\mainfunB421 = \just\excl&\text{--- nem jut el hozzá}\end{cases}\\
		&                                     &&\text{, mert}_1\mainfunA4{1\frac12}4=\just\incl\text{ --- nem jut el hozzá}\\
		&\nomainfunA4{2\frac12}5               &&\text{, mert}_\frac12\begin{cases}\nomainfunB420\end{cases}\\
		&                                     &&\text{, mert}_1\nomainfunA4{1\frac12}5
	\end{align*}

	\begin{align*}
		&\nomainfunA430   &&\text{, mert}_\frac12\begin{cases}\nomainfunB4{2\frac12}4\\\nomainfunB4{2\frac12}5\end{cases}\\
		&                &&\text{, mert}_1\nomainfunA420\\
		&\nomainfunA431   &&\text{, mert}_\frac12\begin{cases}\mainfunB4{2\frac12}3 = \just\incl&\text{--- innen nem juthat tovább}\\\nomainfunB4{2\frac12}4\end{cases}\\
		&                &&\text{, mert}_1\mainfunA421 = \just\excl\\
		&\nomainfunA432   &&\text{, mert }\begin{cases}\mainfunB4{2\frac12}2 = \just\excl&\text{--- innen nem juthat tovább}\\\mainfunB4{2\frac12}3 = \just\incl&\text{--- innen sem juthat tovább}\end{cases}\\
		&\nomainfunA433   &&\text{, mert }\begin{cases}\nomainfunB4{2\frac12}1\\\mainfunB4{2\frac12}2 = \just\excl&\end{cases}\\
		&\nomainfunA434   &&\text{, mert}_\frac12\begin{cases}\nomainfunB4{2\frac12}0\\\nomainfunB4{2\frac12}1\end{cases}\\
		&                &&\text{, mert}_1\nomainfunA424\\
		&\nomainfunA435   &&\text{, mert}_\frac12\begin{cases}\nomainfunB4{2\frac12}0\end{cases}\\
		&                &&\text{, mert}_1\nomainfunA425
	\end{align*}

	Ezzel megvagyunk.

	\subsection{Értéktáblázat}

	Foglaljuk össze a kiszámított értékeket, táblázatosan elrendezve:

	\begin{table}[H]
		\caption*{$\currymainfunA$ (és a vele azonos $\currymainfunB$) relatív alprotokollfüggvény értéktáblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$-\infty$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	\\\hline
			$0$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac12$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
			$1$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac12$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
			$2$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac12$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
			$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac12$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}

	\section{A párkommunikációra elvonatkoztató modellből való visszatérés az eredeti 4-aktoros körre}

	A feladatban természetesen 4 testvér szerepel. Ezért modellezésben való továbblépéshez szükséges, hogy 4 aktor viselkedését modellezzük.
	Mivel az eddigi modellünk 2-aktoros volt, meg kell oldanunk a két modellezési szint közötti hozzárendeléseket.

	Természetesen a kétaktoros modell két elvont aktorát az eredeti testvérek közt úgy osztuk ki, hogy a kezdő testvér (akihez legelőször odalép a király) lesz az egyik aktor (akkor a $\mainfunA{}{}{}$ ír le, a $\mainfunB{}{}{}$ pedig a kezdő testvérrel szemben lévő testvér lesz. De mi legyen a másik két testévérrel (akik a kezdő testvérrel szomszédosak)?

	\subsection{2 új ,,repeater''-aktor, kísértetállomás}

	%Egy későbbi formalizmust előrebocsátva, ,,repeater-szabályok'': $\mainfun1jn = \nothing$ ha $\mainfunA Nqk = \nothing$, és $\nomainfun1jn$ ha $\nomainfunA Nqk \lor \mainfunA Nqk = \just\incl \lor \mainfunA Nqk = \just\excl$.

	A legegyszerűbb megközeltés az, ha megpróbáljuk minél hűbben megőrizni a kétaktoros modell egyszerűségét. Ezért a két ,,új'' aktort csak módfelett ,,lebutított'' formában engedjük be: a ,,fő'' aktorok közti kommunikációs ,,csatornába'' olvadnak be, elírásuk csak arra korlátozódik, hogy egy erre a szerepre korlátozódó megbízható szolgai ,,továbbengedő'' viselkedést deklaráljon.
	Afféle ,,repeater''-ek lesznek, bár ezt a feladat jellegének megfelelően nem ,,ismétléssel'', hanem szolgai ,,Nem tudom!'' válaszokkal lehet modellezni: ők mindig továbbengedik a kört, továbpasszolják a labdát, a ,,protokolltokent'': ,,kísértetállomások'' lesznek.\footnote{A ,,Geisterbahnhof'' kifejezés az NDK idejéből származik, a Fallal megosztott Berlinből. A nyugat-berlini metró egyik vonala  egy rövid szakaszon az NDK-hoz tartozó kelet-berlini területen ment át. A két városrész közti megegyezéés értelmében az NDK megengedte és  üzemeltette is a szerelvények áthaladását, de a keleti szektorba tartozó állomásokat a közönség számára lezárta, ott a ,,nyugati'' szerelvényeknek csak áthaladni volt joguk: az utasok a lezárt, kísérteties, határőrség által őrzött állomásokat csak az ablakból láthatták. Ezeket a ,,csak továbbengedésre'' fentartott állomásokat nevezte a nyugatberlini köznyelv ,,Geisterbahnhof'' néven. Wikipédia-cikk (\href{https://en.wikipedia.org/wiki/Ghost_station}{link}), Youtube-videó (\href{https://www.youtube.com/watch?v=jSwbcCx8rfQ}{link}).}

	Ezt a viselkedést tehát matematikailag a
	
	\begin{align*}
		\gbh Nqk &= \nothing\\\intertext{függvény deklarálja, ahol}
		N &\in \mathbb N\\
		q &\in \setOf{-\infty, 0, \frac14, \frac12, \frac34, 1, 1\frac14, 1\frac12, 1\frac34, \dots}\\
		k &\in \setOf{0, \dots, N + 1}
	\end{align*}

	a leírás pontosan azt viselkedést rögzíti, amit a két új kísértetállomástól elvárunk: a ,,kísértetállomás'' (félreérthető hasonlatként ,,repeater'') nem is figyel argumentumainak értékére, mindenre konstans $\nothing$ választ ad. Az ő feladata tehát tényleg pontosan a ,,továbbengedés''.

	\subsubsection{A (4 aktorra) kiterjesztett relatív protokollfüggvény}

	A $q$ paraméter (eddig megtett menetszám) felvehető értéki szintén kibővültek: már ,,negyedes'' (4-es nevezőjű) törtértékeket is fölvehet. Ennek indítéka, hogy e ,,kísértetállomás''-szabályt be lehessen illeszteni az alábbiakban megadandó \emph{kiterjesztett} relatív protokollfüggvény definíciójába:

	\[
		\mainfunext Nqk =
		\begin{cases}
			\mainfuncomm Nqk & \text{ha } k = -\infty, 0, \frac12, 1, 1\frac12\dots \text{szóval ha ,,egész-vagy-feles'' alakú}\\
			\gbh Nqk \text{ amely } =\nothing & \text{ha } k = \frac14, \frac34, 1\frac14, 1\frac34, 2\frac14\dots \text{szóval ha ,,valódi negyedes'' alakú}
		\end{cases}
	\]

	Ez alapvetően  ,,esetszétválasztós'' definícó: a $\mainfunext Nqk$ kiterjesztett függvényt egyrészt a régi főaktorokat leíró ,,régi'' $\mainfuncomm Nqk$ függvény, részben az új kísértetállomásaktorokat leíró $\gbh Nqk$ függvény alapján ,,rakjuk össze'', egyfajta alternáló esetszétválasztással: a $q$ argumentum értékének ,,negyedes-paritása'' alapján váltakozva.
	Ez a definíció tehát nem rekurzív, és az alábbi értéktáblázat mutatja is az alternáló esetszétválasztást (a szellemállomásokat sárga szín jelzi):

	\begin{table}[H]
		\caption*{A $\mainfunext{}{}{}$ kiterjesztett relatív protokollfüggvény értéktáblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$-\infty$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	\\\hline
			$0$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac14$	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	\\\hline
		$\frac12$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac34$	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	\\\hline
			$1$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac14$	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw		\\\hline
		$1\frac12$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac34$	&	\ylw		&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw		\\\hline
			$2$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac14$	&	\ylw		&	\ylw\nothing	&	\ylw\nothing	&	\ylw\nothing	&	\ylw		&	\ylw		\\\hline
		$2\frac12$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac34$	&	\ylw		&	\ylw		&	\ylw\nothing	&	\ylw\nothing	&	\ylw		&	\ylw		\\\hline
			$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac14$	&	\ylw		&	\ylw		&	\ylw		&	\ylw		&	\ylw		&	\ylw		\\\hline
		$3\frac12$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac34$	&	\ylw		&	\ylw		&	\ylw		&	\ylw		&	\ylw		&	\ylw		\\\hline
		\end{tabular}
	\end{table}

	\subsection{,,Autonómabb'' aktorbővítés --- aktorok egyenrangúsága}

	Jogosan bírálható a fenti megközelítés: a mód, ahogy a kétaktoros modellt négyaktorossá bővítettük.
	Természetesebbnek hat az, ha az új aktorok teljesen egyenrangúak a korábbi főaktorokkal, sőt, akár az egyes aktorok használhatnak teljesen ugyanolyan belső programot, protokollfüggvényt is.
	Ez közelebb áll azokhoz a jelenségekhez is, amelyekben a fizika vizsgálja emergens struktúrák kialakulását: madárrajok, embertömegek (szurkolók hullámban terjedő mintázatai, menekülő tömeg, termeszhangyák várépítése).

	A fő ötlet az, hogy a két ,,új'' aktor ,,egyenjogusítása'': ne legyenek passzív szellemállomás-szerepre kárhoztatva, hanem ők egymás közt éppúgy kommunikáló párost alkotnak, mint ahogy a kétaktoros modell eredeti főaktorai.

	Matematikailag ez azt jelenti, hogy a $\mainfunext Nqk$ definiálására nem az elébbi

	\[
		\mainfunext Nqk =
		\begin{cases}
			\mainfuncomm Nqk & \text{ha } k = -\infty, 0, \frac12, 1, 1\frac12\dots \text{szóval ha ,,egész-vagy-feles'' alakú}\\
			\gbh Nqk \text{ amely } =\nothing & \text{ha } k = \frac14, \frac34, 1\frac14, 1\frac34, 2\frac14\dots \text{szóval ha ,,valódi negyedes'' alakú}
		\end{cases}
	\]

	$q$-alternáló esetszétválasztós definíciót használjuk, hanem az új $\mainfunext Nqk$ függvényt ugyanúgy rekurzívan definiáljuk, ahogy a ,,régi'' $\mainfuncomm{}{}{}$ függvényt, és nagyjából ugyanazon elvek alapján (szinte megismételjük az ott tett rekurziós felépítést, csak itt immár $\mainfunext Nqk$ függvényre értve):

	%Legyen $N \in \mathbb N; k \in \setOf{0, \dots, N+1}$:

	\begin{align}
		\intertext{Legyen $N \in \mathbb N; k \in \setOf{0, \dots, N+1}$:}
		\mainfunext N{-\infty}k &= \nothing
		\\\intertext{Legyen $N \in \mathbb N; q \in \setOf{0, \frac14, \frac12, \frac34}$:}
		\mainfunext Nq{N+1} &= \just\incl
		\\\intertext{Legyen $N \in \mathbb N; q \in \setOf{0, \frac14, \frac12, \frac34, 1, 1\frac14, 1\frac12, 1\frac34 \dots}; k \in \setOf{0, \dots, N}$:}
		\mainfunext Nqk &= \oplus\begin{cases}\displaystyle\mainfunext N{q-\frac12}{N-k}&\\\\\displaystyle\mainfunext N{q-\frac12}{N-k+1}&\end{cases}
	\end{align}

	A $\oplus$ segédfüggvény maradhat teljesen ugyanaz, viszont ami fent definiélt függvényt illeti: a $q$ paraméter lehetséges értékei itt is kibővültek a ,,negyedes értékekkel.

	\begin{table}[H]
		\caption*{Az egymással egyenrangú aktorokkal való kiterjesztés értéktáblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$-\infty$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	\\\hline
			$0$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac14$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac12$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac34$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
			$1$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac14$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac12$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac34$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
			$2$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac14$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac12$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac34$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
			$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac14$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac12$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac34$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}

	Látható a mintázatból, hogy itt az aktorok tényleg egyenrangúak egymással, és egséges módon történik szereposztásuk.

	\section{Az abszolút protokollfüggvény}


	\section{Formalizmus}

	\subsection{Alapfogalmak}

	A kommunikáció nyelvtana: a \emph{protokollfüggvény}. Elsőként \emph{relatív} protkollfüggyvényeket fogunk használni, amelyek egy aktorra, szerelőre vonatkozóan adják meg a protokoll szabályait: ,,ha ennyi bárányt látsz magad körül, és ilyen előzményekre emlékszel (hányadik kör melyik fázisában vagy épp, milyen régen kezdtetek), akkor válaszolj így meg így''.

	Ha mind a négy legény rendre a számára adott relatív protokollfüggvény szerint vselkedik, akkor alakul ki afféle ,,emergens jelenségként'' a teljes viselkedés, ami révén együttesen képesk helyesen megfelelni a királynak mindenféle lehetséges esetben.

	Az így kiboontakozó problémamegoldó rendszert jellemezhetjük determinisztikusbban is: nem egyéni protokollok emergens eredőjeként, hanem magát az egész viselkedést egyetlen táblázattal, fekete dobozként, tekintet nélkül az annak részeit alkotó egyéni aktorok szemszögére. A megoldást jelető protokollt ílyen ,,külső szemmel'' megadó függvény az \emph{abszolút protokollfüggvény}.

	\subsection{Relatív protokollfüggvény}



	\section{Relatív táblák}

	Alap (,,feles'') relatív tábla, (negyedekre) kiterjesztett relatív tábla, (egészekre) leszűkített relatív tábla. Alternatív jelölésrendszerek rájuk:
	\begin{table}[H]
		\caption*{Relatív táblák változatai részletezés szerint,\\és szóbajövő jelölési alternatívák}
		\centering
		\begin{tabular}{c|ccc}
			             &  Alap                             &  Kiterjesztett                     &  Leszűkített\\\hline\hline
			Jelölés I    &  $\currymainfun{}$                &  $\uparrow\!\!\!\currymainfun{}$       &  $\downarrow\!\!\!\currymainfun{}$\\\hline
			Jelölés II   &  $\currymainfun{}$                &  ${}^{\mathghost}\!\!\!\currymainfun{}$  &  ${}_{\mathghost}\!\currymainfun{}$\\\hline
			Jelölés III  &  ${}_{\frac12}\!\!\currymainfun{}$  &  ${}_{\frac14}\!\!\currymainfun{}$   &  ${}_1\!\!\currymainfun{}$
		\end{tabular}
	\end{table}

	\subsection{Alap-reltábla: az elvonatkoztatott model fő kommunikációs felei}

	Ezt fejezi ki a leszűkített relatív tábla:


	\section{Kiterjesztett reltábla: a párkommunikáció-elvonatkoztatásból való visszalépés}

	A másik két testvér táblázatának kitöltésen nehezebb, hiszen a fentebbi modellek lényegében két kommunikáló félre redukálják a sémát.
	Az \#1 és \#3 indexű testvér lényegében csak afféle ,,vezeték'' ebben,hogy ez a fajta absztrakció ehetővé váljék, szerepük implicit.
	Mindenesetre ettől függetlenül nekik is konrét táblát kell adni, sőt, nemcsak az abszolút, hanem már itt a relatív tábla terén is is.

	\subsection{A repeater-szabályok}

	A ,,repeater-szabályok'': $\mainfun1jn = \nothing$ ha $\mainfunA Njn = \nothing$, és $\nomainfun1jn$ ha $\nomainfunA Njn \lor \mainfunA jn = \just\incl \lor \mainfunA jn = \just\excl$.

	\begin{table}[H]
		\caption*{$\currymainfun1$ és $\currymainfun3$ relatív táblázata: a repeater szerep elfogadása esetén}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$-\infty$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	\\\hline
		$\frac14$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac34$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$1\frac14$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac34$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$2\frac14$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac34$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$3\frac14$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac34$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}


	Elvileg a Dom (tök és koponya)-függvényeknek is van kiterjesztett változata.

	\subsection{A repeater-szabályok levezethetősége, implicitálódása}

	Valójában persze a repeater-szabáyloknak elég a feladat szempontjából fontos esetekben megvalósulniuk. Azokon a pontokon, amelyek a rekurzív hívásokat nem rontják el érdemben, ott megengedhető a repeater-szabályoktól való eltérés.

	\begin{table}[H]
		\caption*{A $\currymainfunA$ és $\currymainfunB$ párocska relatív táblázata\\közös táblázatba vehető a $\currymainfun1$ és $\currymainfun3$ párocska relatív táblázatával\\tehát $\currymainfun{*}$ egységes relatív táblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$-\infty$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	\\\hline
			$0$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac14$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac12$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$\frac34$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
			$1$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac14$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac12$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$1\frac34$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
			$2$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac14$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac12$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$2\frac34$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
			$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac14$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac12$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		$3\frac34$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}

	\setlength{\extrarowheight}{8px}

	\begin{table}[H]
		\caption*{Abszolút tábla (az $\eye$ abszolút protokollfüggvény)}
		\centering
		\begin{tabular}{c|c|c|c|c|c|c|c|}
			\multirow{2}{*}{Menet} &  \multirow{2}{*}{Legény}  &    \multicolumn{6}{c|}{Számolható bárányok}                           \\
			                       &                           &    0                         &    1                         &    2                         &    3                         &    4                &    5      \\\hline\hline
			\multirow{4}{*}{0}     &  0                        &    $\mainfunext400$           &    $\mainfunext401$           &    $\mainfunext402$           &    $\mainfunext403$           &    $\mainfunext404$          &    $\mainfunext405$          \\\cline{2-8}
			                       &  1                        &    $\mainfunext4{\frac14}0$   &    $\mainfunext4{\frac14}1$   &    $\mainfunext4{\frac14}2$   &    $\mainfunext4{\frac14}3$   &    $\mainfunext4{\frac14}4$  &    $\mainfunext4{\frac14}5$  \\\cline{2-8}
			                       &  2                        &    $\mainfunext4{\frac12}0$   &    $\mainfunext4{\frac12}1$   &    $\mainfunext4{\frac12}2$   &    $\mainfunext4{\frac12}3$   &    $\mainfunext4{\frac12}4$  &    $\mainfunext4{\frac12}5$  \\\cline{2-8}
			                       &  3                        &    $\mainfunext4{\frac34}0$   &    $\mainfunext4{\frac34}1$   &    $\mainfunext4{\frac34}2$   &    $\mainfunext4{\frac34}3$   &    $\mainfunext4{\frac34}4$  &    $\mainfunext4{\frac34}5$  \\\hline\hline
			\multirow{4}{*}{1}     &  0                        &    $\mainfunext410$           &    $\mainfunext411$           &    $\mainfunext412$           &    $\mainfunext413$           &    $\mainfunext404$          &    $\mainfunext405$          \\\cline{2-8}
			                       &  1                        &    $\mainfunext4{1\frac14}0$  &    $\mainfunext4{1\frac14}1$  &    $\mainfunext4{1\frac14}2$  &    $\mainfunext4{1\frac14}3$  &    $\mainfunext4{\frac14}4$  &    $\mainfunext4{\frac14}5$  \\\cline{2-8}
			                       &  2                        &    $\mainfunext4{1\frac12}0$  &    $\mainfunext4{1\frac12}1$  &    $\mainfunext4{1\frac12}2$  &    $\mainfunext4{1\frac12}3$  &    $\mainfunext4{\frac12}4$  &    $\mainfunext4{\frac12}5$  \\\cline{2-8}
			                       &  3                        &    $\mainfunext4{1\frac34}0$  &    $\mainfunext4{1\frac34}1$  &    $\mainfunext4{1\frac34}2$  &    $\mainfunext4{1\frac34}3$  &    $\mainfunext4{\frac34}4$  &    $\mainfunext4{\frac34}5$  \\\hline\hline
			\multirow{4}{*}{2}     &  0                        &    $\mainfunext420$           &    $\mainfunext421$           &    $\mainfunext422$           &    $\mainfunext423$           &    $\mainfunext404$          &    $\mainfunext405$          \\\cline{2-8}
			                       &  1                        &    $\mainfunext4{2\frac14}0$  &    $\mainfunext4{2\frac14}1$  &    $\mainfunext4{2\frac14}2$  &    $\mainfunext4{2\frac14}3$  &    $\mainfunext4{\frac14}4$  &    $\mainfunext4{\frac14}5$  \\\cline{2-8}
			                       &  2                        &    $\mainfunext4{2\frac12}0$  &    $\mainfunext4{2\frac12}1$  &    $\mainfunext4{2\frac12}2$  &    $\mainfunext4{2\frac12}3$  &    $\mainfunext4{\frac12}4$  &    $\mainfunext4{\frac12}5$  \\\cline{2-8}
			                       &  3                        &    $\mainfunext4{2\frac34}0$  &    $\mainfunext4{2\frac34}1$  &    $\mainfunext4{2\frac34}2$  &    $\mainfunext4{2\frac34}3$  &    $\mainfunext4{\frac34}4$  &    $\mainfunext4{\frac34}5$  \\\hline\hline
			\multirow{4}{*}{3}     &  0                        &    $\mainfunext430$           &    $\mainfunext431$           &    $\mainfunext432$           &    $\mainfunext433$           &    $\mainfunext404$          &    $\mainfunext405$          \\\cline{2-8}
			                       &  1                        &    $\mainfunext4{3\frac14}0$  &    $\mainfunext4{3\frac14}1$  &    $\mainfunext4{3\frac14}2$  &    $\mainfunext4{3\frac14}3$  &    $\mainfunext4{\frac14}4$  &    $\mainfunext4{\frac14}5$  \\\cline{2-8}
			                       &  2                        &    $\mainfunext4{3\frac12}0$  &    $\mainfunext4{3\frac12}1$  &    $\mainfunext4{3\frac12}2$  &    $\mainfunext4{3\frac12}3$  &    $\mainfunext4{\frac12}4$  &    $\mainfunext4{\frac12}5$  \\\cline{2-8}
			                       &  3                        &    $\mainfunext4{3\frac34}0$  &    $\mainfunext4{3\frac34}1$  &    $\mainfunext4{3\frac34}2$  &    $\mainfunext4{3\frac34}3$  &    $\mainfunext4{\frac34}4$  &    $\mainfunext4{\frac34}5$  \\\hline
		\end{tabular}
	\end{table}

	\setlength{\extrarowheight}{4px}

	\begin{table}[H]
		\caption*{Abszolút tábla}
		\centering
		\begin{tabular}{c|c|c|c|c|c|c|c|}
			\multirow{2}{*}{Menet} &  \multirow{2}{*}{Legény}  &    \multicolumn{6}{c|}{Számolható bárányok}                                                          \\
				               &                           &    0              & 1              & 2              & 3              & 4              & 5              \\\hline\hline
			\multirow{4}{*}{0}     &  0                        &    \nothing       & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\cline{2-8}
				               &  1                        &    \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   \\\cline{2-8}
				               &  2                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\cline{2-8}
				               &  3                        &    \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   \\\hline\hline
			\multirow{4}{*}{1}     &  0                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \grn\just\incl & \blk           \\\cline{2-8}
				               &  1                        &    \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw           \\\cline{2-8}
				               &  2                        &    \blk           & \red\just\excl & \nothing       & \nothing       & \grn\just\incl & \blk           \\\cline{2-8}
				               &  3                        &    \ylw           & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw           \\\hline\hline
			\multirow{4}{*}{2}     &  0                        &    \blk           & \red\just\excl & \nothing       & \grn\just\incl & \blk           & \blk           \\\cline{2-8}
				               &  1                        &    \ylw           & \ylw\nothing   & \ylw\nothing   & \ylw\nothing   & \ylw           & \ylw           \\\cline{2-8}
				               &  2                        &    \blk           & \blk           & \red\just\excl & \grn\just\incl & \blk           & \blk           \\\cline{2-8}
				               &  3                        &    \ylw           & \ylw           & \ylw\nothing   & \ylw\nothing   & \ylw           & \ylw           \\\hline\hline
			\multirow{4}{*}{3}     &  0                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\cline{2-8}
				               &  1                        &    \ylw           & \ylw           & \ylw           & \ylw           & \ylw           & \ylw           \\\cline{2-8}
				               &  2                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\cline{2-8}
				               &  3                        &    \ylw           & \ylw           & \ylw           & \ylw           & \ylw           & \ylw           \\\hline
		\end{tabular}
	\end{table}


	\begin{table}[H]
		\caption*{Abszolút tábla}
		\centering
		\begin{tabular}{c|c|c|c|c|c|c|c|}
			\multirow{2}{*}{Menet} &  \multirow{2}{*}{Legény}  &    \multicolumn{6}{c|}{Számolható bárányok}                                                          \\
				               &                           &    0              & 1              & 2              & 3              & 4              & 5              \\\hline\hline
			\multirow{4}{*}{0}     &  0                        &    \nothing       & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\cline{2-8}
				               &  1                        &    \nothing       & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\cline{2-8}
				               &  2                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\cline{2-8}
				               &  3                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \nothing       & \grn\just\incl \\\hline\hline
			\multirow{4}{*}{1}     &  0                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \grn\just\incl & \blk           \\\cline{2-8}
				               &  1                        &    \red\just\excl & \nothing       & \nothing       & \nothing       & \grn\just\incl & \blk           \\\cline{2-8}
				               &  2                        &    \blk           & \red\just\excl & \nothing       & \nothing       & \grn\just\incl & \blk           \\\cline{2-8}
				               &  3                        &    \blk           & \red\just\excl & \nothing       & \nothing       & \grn\just\incl & \blk           \\\hline\hline
			\multirow{4}{*}{2}     &  0                        &    \blk           & \red\just\excl & \nothing       & \grn\just\incl & \blk           & \blk           \\\cline{2-8}
				               &  1                        &    \blk           & \red\just\excl & \nothing       & \grn\just\incl & \blk           & \blk           \\\cline{2-8}
				               &  2                        &    \blk           & \blk           & \red\just\excl & \grn\just\incl & \blk           & \blk           \\\cline{2-8}
				               &  3                        &    \blk           & \blk           & \red\just\excl & \grn\just\incl & \blk           & \blk           \\\hline\hline
			\multirow{4}{*}{3}     &  0                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\cline{2-8}
				               &  1                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\cline{2-8}
				               &  2                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\cline{2-8}
				               &  3                        &    \blk           & \blk           & \blk           & \blk           & \blk           & \blk           \\\hline
		\end{tabular}
	\end{table}



	A ,,negyedes'' legények (1, 3) kitöltéskekor érzékeljük, hogy információveszteség történik: nem figyljük, egy-egy legény mennyi bárányt számol az egyik irányban külön és a másik irányban külön.
	Ez a fajta információvesztés --- ,,a karok vesztesége'' --- a később említendő ,,oprtimalitás tétele'' szempontjából lesz érdekes.

	\section{Tételek és kérdések}

	\subsection{Az autonómia tétele és az optimalitás tétele}

	Az autónómia téetle aztmondja ki, hog az 1-es és 3-as legénynek nem kell kólon \texttt{const Nothing} jellegű szabályokat előírnunk.
	Dolgozhatnak ugyanazzal a semeatikával, mint a 0-s és 2-es legény. Persze a konrét forgatókönyvekben vanóba afféle \texttt{const Nothing} repeater jellegű szerep hárul rájuk,
	de ez automatikusan áll elŐ: egyszerűen abból fakad. hogy az ő információjuk előrehaladottsgi foka kisebb, mint az éppen érdeklődés alaptt álló legényé, így a rekurziók során ténylegesen előhívásra kerülő helyzetekben ők tényleg Nothingot nyújtnak a számára.

	Az optimalitás tétele hasonló jellegű. Attól még hogy bebizonosodik, hogy az itt tárgyalt sematika tud jó válaszokat asni a kiránynak a keretek közt, attól még elvileg lehetnek nehézségek a feladat kérdéseinek megadásában:

	\begin{quotation}
		Meg tudjátok mondani, hogy melyik legény felelt meg, hányadik kérdésre, és mit felelt?
	\end{quotation}

	Ehhez nem elég tudnunk azt, hogy mi egy jó jóslófüggvény, ehhez azt is tudnunk kell, hogy a jóslófüggvény létezése bizonyos értleemben megköti a lehetőségeket, és nem lehetsége,s hogy eg másik jóslófüggvényt használva a fiók képesek lennének megfelelni a királynak, de a feladat kérdésére más válasz adódnék.

	Előfordulhat az, hogy az optimaliás tétele nem igaz, és a feladatnak egy akár életszerűtlen de létző alternatív megoldás is van?

	Az optimaliás tételét jelenleg nem tudom bizonyítani, de a feladat impliciten kihasználja, előfeletételezi fennállását. Így a feladat szószerinti kérdésére tett választ ennek figyelembevételével közlöm.

	\subsection{MI-autonómia, emergencia?}

	A harmadik kérdés még e területen inkább kihívás, mint tétel, az autonómia még tovább vitele. Ez a négyfitút mint önálló autonóm aktort, genst még tovább viszi. Lehetséges-e olyan MI-programot írni, ahol a jóslófüggvényre a program magától jön rá, persze a királlyal való előzetes ,,dry run'' próbajászmák során? Felmutatható-e egy ilyen webalkalmazás? Ez esetben a fiúk egyöntetűen sak egy ilyen tanuló algoritmussal érkeznek. Minden máásra már dry run próbaajátékok során kell rájönni tudniuk.

	Mindenesetre programozóknak e kérdéskor jó ,,ürügyet'' ad elosztott algoritmusok, felhőwebalkalmazások gyakorlására.

	Ami viszont innen már a fizika kérdésköreihez is vezethet: emergencia, emergens rendszerek, egyéb önszabályozási kérdések, flock jelenségek. Biológiai és társadalmi példák: tömeg visekledése (diszkótűz, szurkolótömegben hullámok), biológiában a termeszek bárépítő emergenciája jóval egyszerűbb egyéni alkoritmusok alapján, amelyek az egyedekben egységes(ebb)en vannak benne.

	\section{Abszolút táblák}

	A fenti kérdések megközelítéséhez tovább kell lépnünk a modellezésben: élően meg kell valósítanunk a feladatot.
	A korét leprogramozásnál érdemes meghatároznunk a már végső kódot közvetlenül irányító abszolút táblákat.
	Nem feletétlen kell a porgramnak ezeket használnia: az autonómia tétele szerint elegendő a relatívá táblákat használnunk.
	A relatív táblákat eekkor emergens viselekedés eredményeként kapjuk, deklarálásuk tehát implicit, illetve esetleg a tesztek tartalmazzák.
	De épp ezért, akár csak tesztcélokból is, de érdemes önállóan is meghatárznunk az abszolút táblákat.

	Jelölésben a macskás boszorkány.

	\subsubsection{Az elvonatkoztatott model fő kommunikációs felei}

	\begin{table}[H]
		\caption*{$\currymainfunabs0$ abszolút táblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
			$0$	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
			$1$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
			$2$	&	\blk		&	\red\just\excl	&	\nothing	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
			$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}

	\begin{table}[H]
		\caption*{$\currymainfunabs2$ abszolút táblázata}
		\centering
		\begin{tabular}{c||c|c|c|c|c|c|c|}
				&	$0$		&	$1$		&	$2$		&	$3$		&	$4$		&	$5$		\\\hline\hline
		$0$	&	\red\just\excl	&	\nothing	&	\nothing	&	\nothing	&	\nothing	&	\grn\just\incl	\\\hline
		$1$	&	\blk		&	\red\just\excl	&	\nothing	&	\nothing	&	\grn\just\incl	&	\blk		\\\hline
		$2$	&	\blk		&	\blk		&	\red\just\excl	&	\grn\just\incl	&	\blk		&	\blk		\\\hline
		$3$	&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		&	\blk		\\\hline
		\end{tabular}
	\end{table}

	\paragraph{Egy teljes alternatív kiépítése az egésznek}
	A tábla szimmetriája miatt az egész feladat tárgyalását fel lehetne építeni matematikailag is és didaktikailag is úgy, hogy eleve  ezt a táblázatot ismerjük fel (létezik hétköznapi foglamakkal megadható leírás és rávezetés).

	\subsection{A párkommunikáció-elvonatkoztatásból való visszalépés}

	\subsubsection{A kimaradt abszolút és relatív táblák}

	\begin{table}[H]
		\caption*{$\currymainfun1$ relatív táblázata}
		\centering
	\end{table}

	\begin{table}[H]
		\caption*{$\currymainfun3$ relatív táblázata}
		\centering
	\end{table}

	\begin{table}[H]
		\caption*{$\currymainfunabs1$ abszolút táblázata}
		\centering
	\end{table}

	\begin{table}[H]
		\caption*{$\currymainfunabs3$ abszolút táblázata}
		\centering
	\end{table}

	\section{Egyéb kísérleti fogalmak bölcseje}

	\subsection{Progressziós/előrehaladottsági érték}
	\begin{displaymath}
		\progr{\text{fehér}} < \progr{\text{színes}} < \progr{\text{fekete}}
	\end{displaymath}
	vagyis
	\begin{align*}
		\progr{\mathwitch=\nothing} < &\progr{\mathwitch=\just\incl} < \progr{\bigskull}\\
		                            < &\progr{\mathwitch=\just\excl} <
	\end{align*}
	\subsection{Szabályok}

	\subsection{Rekurziós gráf}

	Szintezettség, hasonló a táblázathoz, de az indeterminisztikus komplementaritás miatt az élek kuszák a szintek között.

	\section{Tesztelő keretrendszer aktorszereposztása}

	Van a négy azonos típusú és viselkedésű aktor, akik közös protokollfügyvény szerint viselkednek, és van a király mint egy magasabb szinten vett másik fél.

	Érdekesség még, hogy a négy testvéraktor esetében is valójában a szembelevők közt zajlik az érdemi kommunikáció. Lehet, hogy létezik optimálisabb protokoll is (amely nem egyszerűűsíti le a négy testvérktort kettőre, és ezt kihasználva hatékonyabb), de a protokoll optimalitása nem feladat, csak a korlátokon belül maradása.

	\section{Hálózati alkalmazások, játékok}

	Az 1-játékosú játék, még szoliternek sem nevezhető, hiszen itt az egyetlen játékos szerepét a gép játssza, külső játékos (felhasználó) nincs is. Webalkalmazásképp nem is interaktivitási okokból érdemes megcsinálni, legfeljebb adott paraméterezésű (pl.~100-birkás, 50-50-50-50-partíciós) játék stratégiáinak teszteléseként.

	A 2-játékosú játék már érdekes, itt van egy külső játékos: vagy a király, vagy a testvérnégyes. Itt azonban didaktikai és játékfejlesztési jelentősége egy szereposztás-megválasztható webalkalmazásnak van. A felhasználó először a testvérnégyes szerepét játszva mérközik a királlyal (a géppel). Ebből tanulva, gyakorolva felfedezve láthat neki a fordított szereposztásnak.

	A 3, 4, 5 játékosú játékok szzimetrikusan: a testvrnégyest bontjuk fel. A 6-játékosú játék teljsen fölvan bontva. Mikroszervizek szempontjából lehetnek érdekesek.

	Érdekesek lehetnek olyan játékok, ahol ugyan több gépi vagy több emberi játékos is van, de ezek mikroszervizesen, hálózati úton tartják a kapcsolatot. Midenesetre programozás gyakorlása szempontjából érdekes, játék szempontjából még nem látom hasznukat, bár lehet hogy van ilyen. Didakitukailag érdekes lehet, hogy több gyerek játszhat egyszerre, pl. a néhy testvér szerepében rendre, esetleg közülük kettőt vagy hármat vagy mind a négyet ,,tömbösítve''.

	Olyan játék, ahol a birkák összlétszámát, vagy a kör méretét a játékos nem is tudja, és neki kell kitalálnia (esetleg több élet engedélyezésével?) Van-e ilyen?

	A továbbiakban a kétjátékosú játék, és a szereposztásmegválasztható webalkalmazás fejlesztéséről lesz szó.

	\section{Általánosítások}

	Köráltalánosítás? (A körredukció mintáájára). Létszámáltalánosítás, illetveennek részeként partícióáltalánosítás? A király egyéb feltételei (tudjuk a látszámot, tudjuk a kör méretét, a király szigorúsága, a meggengedett körök száma).
\end{document}
